<!DOCTYPE html>
<html>
<head>
  <title>Screen Watcher</title>
  <script src="https://cdn.socket.io/4.8.0/socket.io.min.js" integrity="sha384-OoIbkvzsFFQAG88r+IqMAjyOtYDPGO0cqK5HF5Uosdy/zUEGySeAzytENMDynREd" crossorigin="anonymous"></script>
</head>
<body>
  <h1>Screen Watcher</h1>
  <video id="videoPlayer" controls autoplay></video>

  <script>
    const videoElement = document.getElementById('videoPlayer');
    const socket = io(); // Connect to the server
    const mediaSource = new MediaSource();

    videoElement.src = URL.createObjectURL(mediaSource);

    mediaSource.addEventListener('sourceopen', () => {
      const sourceBuffer = mediaSource.addSourceBuffer('video/webm; codecs="vp8, opus"'); // Adjust codecs as needed

      socket.on('videoData', (base64Data) => {
        const binaryString = window.atob(base64Data); // Decode base64 to binary
        const len = binaryString.length;
        const bytes = new Uint8Array(len);

        for (let i = 0; i < len; i++) {
          bytes[i] = binaryString.charCodeAt(i);
        }

        console.log(bytes.buffer);
        sourceBuffer.appendBuffer(bytes.buffer); // Append to the video buffer
      });
    });
  </script>
</body>
</html>

